---
title: "explanations"
format: html
editor: visual
---

## Quarto

$$
\hat{\theta}_i^{\mathrm{DIR}} = \theta_i + \epsilon_i; \quad \epsilon_i \sim^{\mathrm{ind}} \mathcal{N}(0, V_i), \quad i = 1, \ldots
$$

## Explanation

This model describes a situation where you have a set of direct estimates for some parameters, and you're trying to understand the relationship between these estimates and the true, underlying parameters. Let's break down each element:

-   $i = 1, \ldots, M$: This indicates that there are $M$ different units or groups for which you have data. The subscript $i$ is an index that refers to each of these individual units.

-   $\hat{\theta}_i^{\mathrm{DIR}}$: This is the **direct estimator** for the parameter of interest for unit $i$. The "hat" symbol ($\hat{}$) is a standard notation in statistics to denote an estimator or a sample-based estimate of a parameter. The superscript "DIR" stands for "direct," which implies that this estimate is derived directly from the data of unit $i$ alone, without borrowing any information from other units. A classic example would be the sample mean of a group.

-   $\theta_i$: This is the **true, underlying value** of the parameter for unit $i$. This is a fixed, but unknown, value that you are trying to estimate. It's the "real" value that the direct estimator is trying to approximate.

-   $\epsilon_i$: This represents the **sampling error** or **measurement error** for unit $i$. It's the difference between your direct estimate ($\hat{\theta}_i^{\mathrm{DIR}}$) and the true value ($\theta_i$). It accounts for the fact that your direct estimate is not perfect and will deviate from the true value due to random chance, sampling variability, or other sources of error.

-   $\epsilon_i \sim^{\mathrm{ind}} \mathcal{N}(0, V_i)$: This part describes the statistical properties of the sampling error:

    -   $\sim$: This symbol means "is distributed as."
    -   $\mathrm{ind}$: This stands for "independently." It means that the sampling error for one unit ($\epsilon_i$) is not correlated with the sampling error for any other unit ($\epsilon_j$ where $i \neq j$). The errors are independent of each other.
    -   $\mathcal{N}(0, V_i)$: This specifies a **normal distribution**.
        -   $0$: This is the **mean** of the distribution. A mean of zero implies that the direct estimator ($\hat{\theta}_i^{\mathrm{DIR}}$) is an **unbiased** estimator of the true parameter ($\theta_i$). In other words, on average, the direct estimate will equal the true value.
        -   $V_i$: This is the **variance** of the distribution. It represents the degree of uncertainty or variability in the direct estimate for unit $i$. A larger $V_i$ indicates that the direct estimate is less precise and more spread out from the true value. Importantly, the variance is specific to each unit $i$, meaning that the precision of the direct estimates can vary across the different units.

In summary, the model states that the direct estimate for each unit is the true value plus some random, normally distributed error. This error has a mean of zero (so the estimate is unbiased) and a variance ($V_i$) that can be different for each unit, reflecting varying levels of precision in the direct estimates. This model is a foundational component of many statistical methods, particularly in areas like small area estimation, where direct estimates for some units might have very large variances.

## Direct Estimator

In very basic terms, a **direct estimator** is an estimate of a value that is calculated using **only the data from the group you are interested in**. You don't use any information from other groups or any models that try to predict what the value should be.

Think of it like this: if you want to know the average height of students in a specific classroom, you would go into that classroom, measure the height of every student (or a sample of them), and then calculate the average. The result you get is a direct estimate.

The key point is that the estimate for that specific classroom is based purely on the data collected *from that classroom alone*.

### Numeric Example:

Let's say a school has three classrooms: Room A, Room B, and Room C. We want to find the average height of students in each room.

We take a small sample from each room:

-   **Room A:** We measure 5 students and their heights are: 150 cm, 155 cm, 160 cm, 152 cm, 158 cm.

    -   To get the direct estimate for the average height in Room A, we just calculate the average of these 5 numbers:

        -   (150+155+160+152+158)/5=775/5=155 cm.

    -   So, our direct estimate for Room A is **155 cm**.

-   **Room B:** We measure 4 students and their heights are: 145 cm, 150 cm, 148 cm, 162 cm.

    -   The direct estimate for the average height in Room B is:

        -   (145+150+148+162)/4=605/4=151.25 cm.

    -   So, our direct estimate for Room B is **151.25 cm**.

-   **Room C:** We only have data for 2 students, and their heights are: 170 cm, 168 cm.

    -   The direct estimate for the average height in Room C is:

        -   (170+168)/2=338/2=169 cm.

    -   So, our direct estimate for Room C is **169 cm**.

The number we calculated for each room is a direct estimate because it uses only the data from that specific room to create the estimate.

### Why this can be a problem:

Look at Room C. Our direct estimate is 169 cm, which seems quite high compared to the other rooms. But we only have data from two students! It's very possible that we just happened to sample the two tallest students in that room. The true average height for Room C might be much lower. This is an example of a direct estimate with a large variance (high uncertainty) because of the small sample size. This is where more advanced statistical techniques, like small area estimation, would come in to "borrow" information from Rooms A and B to create a more reliable estimate for Room C.

### Numeric Example: Average Income in Austrian Districts

Let's imagine we are a national statistics office and we've conducted a survey to estimate the average household income across all 94 districts of Austria. The survey is a representative sample, but the number of sampled households varies significantly from one district to another.

The "direct estimator" for the average income in each district is simply the average of the incomes of the households sampled **in that specific district**.

Let's look at three hypothetical districts:

-   **District 1: Wien (Vienna) - a highly populated urban district.**

    -   Our survey sampled a large number of households, say 200.

    -   We add up the total income of all 200 sampled households and divide by 200.

    -   Let's say the total income is €9,000,000.

    -   **Direct Estimate for District 1:** 9,000,000/200=€45,000.

    -   Because the sample size is large (200 households), this direct estimate is likely to be quite reliable and have a relatively small variance.

-   **District 2: Graz - a medium-sized urban district.**

    -   Our survey sampled a moderate number of households, say 50.

    -   We add up the total income of these 50 households and divide by 50.

    -   Let's say the total income is €2,300,000.

    -   **Direct Estimate for District 2:** 2,300,000/50=€46,000.

    -   The sample size is smaller, so the estimate is less reliable than for District 1. Its variance is larger, meaning there's more uncertainty around this estimate.

-   **District 3: Murau - a sparsely populated, rural district.**

    -   Due to its low population density, our survey only managed to sample a very small number of households, say just 3.

    -   The incomes of these 3 sampled households are: €30,000, €40,000, and €100,000.

    -   To get the direct estimate for Murau, we calculate the average of these three incomes:

        -   (30,000+40,000+100,000)/3=170,000/3≈€56,667.

    -   **Direct Estimate for District 3:** **€56,667**.

### The Problem with Direct Estimators in this Scenario

Looking at the direct estimate for Murau (€56,667), it's the highest of the three districts. However, this estimate is based on only **three** households. It's highly probable that we happened to sample a household with a very high income (€100,000 in this case), which has a disproportionate effect on the average. If we had sampled a different set of three households in Murau, the average income could have been drastically different.

This is the key problem: the direct estimate for Murau has an extremely **large variance** (high uncertainty). We cannot be confident that €56,667 is a good representation of the true average income for the entire district. In this situation, the direct estimate is unreliable and potentially misleading.

This is an excellent way to connect the abstract model to a concrete example. Let's map each element of the model to our Austria district income example.

The model is: $$\hat{\theta}_i^{\mathrm{DIR}} = \theta_i + \epsilon_i; \quad \epsilon_i \sim^{\mathrm{ind}} \mathcal{N}(0, V_i), \quad i = 1, \ldots, M$$

### The Elements Mapped to the Austria Example

-   $i = 1, \ldots, M$: This refers to the individual **districts** in Austria.
    -   $i=1$ could be our example of Wien.
    -   $i=2$ could be Graz.
    -   $i=3$ could be Murau.
    -   $M$ would be the total number of districts in Austria (which is 94).
-   $\hat{\theta}_i^{\mathrm{DIR}}$: This is the **direct estimator** of the average household income for district $i$. It's the number we calculated purely from the survey data within that district.
    -   For Wien ($i=1$), $\hat{\theta}_1^{\mathrm{DIR}} = €45,000$.
    -   For Graz ($i=2$), $\hat{\theta}_2^{\mathrm{DIR}} = €46,000$.
    -   For Murau ($i=3$), $\hat{\theta}_3^{\mathrm{DIR}} = €56,667$.
-   $\theta_i$: This is the **true average household income** for district $i$. This is the real, fixed value we are trying to find, but we don't know it exactly.
    -   For Wien, $\theta_1$ is the true average income, which might be close to our estimate of €45,000.
    -   For Graz, $\theta_2$ is the true average income.
    -   For Murau, $\theta_3$ is the true average income. Our estimate of €56,667 is likely a poor approximation of this true value.
-   $\epsilon_i$: This is the **error** or **difference** between our direct estimate and the true average income.
    -   For Wien, $\epsilon_1 = \hat{\theta}_1^{\mathrm{DIR}} - \theta_1 = €45,000 - \theta_1$. This error is probably small because our sample size was large.
    -   For Murau, $\epsilon_3 = \hat{\theta}_3^{\mathrm{DIR}} - \theta_3 = €56,667 - \theta_3$. This error is likely to be very large because our sample was so small and unrepresentative.
-   $\epsilon_i \sim^{\mathrm{ind}} \mathcal{N}(0, V_i)$: This describes the statistical properties of that error term.
    -   **"ind" (independently)**: This means that the error in our income estimate for Wien ($\epsilon_1$) is not influenced by the error in our estimate for Murau ($\epsilon_3$). The sampling process in one district is independent of the sampling process in another.
    -   $\mathcal{N}(0, V_i)$ (Normally distributed with mean 0 and variance $V_i$):
        -   The **mean of 0** means our direct estimates are **unbiased**. In other words, if we were to repeat our sampling process for Murau many, many times, the average of all our direct estimates would be the true average income for that district ($\theta_3$). Our one estimate of €56,667 is just one "draw" from a wide normal distribution of possible estimates.
        -   The **variance** $V_i$: This is the most crucial part for our example.
            -   For Wien, $V_1$ is **small** because our sample size was large (200 households). The distribution of possible direct estimates is a tight bell curve centered around the true value.
            -   For Murau, $V_3$ is **very large** because our sample size was tiny (3 households). The distribution of possible direct estimates is a very wide, flat bell curve. Our single estimate of €56,667 is just one point from this very wide range of possibilities, making it a very uncertain and unreliable estimate of the true average income.

This is an excellent step. The formula you've provided is the specific mathematical representation of the "direct estimator" we've been discussing. Let's break it down in the context of our Austrian districts and average income example.

The formula is: $$\hat{\bar{Y}}_d = \frac{1}{N_d} \sum_{i \in s_d} w_{di}Y_{di}$$

This formula is for a specific type of direct estimator, a **weighted sample mean**, which is very common in survey statistics. The weights ($w_{di}$) are crucial for making the sample representative of the population.

### Mapped to the Austrian Districts Example

-   $\hat{\bar{Y}}_d$: This is the notation for the **direct estimate of the average income** for district $d$. It is the same as $\hat{\theta}_d^{\mathrm{DIR}}$ from our earlier model. The "hat" ($\hat{}$) means it's an estimate, the bar ($\bar{Y}$) means it's an average (mean), and the subscript $d$ refers to the specific district.

-   $d$: This is the index for a specific district. It is the same as the $i$ from our earlier model. So, $d$ could represent Wien, Graz, or Murau.

-   $N_d$: This is the **total population size of district** $d$. In our income example, this would be the total number of households in the district. We assume this number is known from a census or other reliable source.

-   $\sum_{i \in s_d}$: This is the summation notation. It tells us to add up a value for every household $i$ that is in our sample for district $d$.

    -   $s_d$ is the set of sampled households in district $d$.
    -   $i \in s_d$ means "for every household $i$ that belongs to the sample for district $d$."

-   $Y_{di}$: This is the **income of an individual sampled household** $i$ within district $d$.

-   $w_{di}$: This is the **sampling weight** for household $i$ in district $d$. This is the key element that makes the estimate representative. The weight for a household reflects how many households in the entire district it represents.

    -   For example, if a household has a weight of 100, it means that household represents itself and 99 other households in the district that were not sampled but have similar characteristics.
    -   The weights are often calculated based on the sampling design (e.g., probability of a household being selected) and are adjusted for non-response and other factors.

### Putting it all together with our example:

Let's revisit our simple calculation for **Murau (District** $d=3$), which had a tiny sample of 3 households.

Our simplified calculation was: $(30,000 + 40,000 + 100,000) / 3 \approx €56,667$

This simplified version implicitly assumes that all households have an equal weight of 1 (a simple random sample). The more formal formula you provided accounts for the complexity of real-world survey designs.

Let's imagine the true weights for our 3 sampled households in Murau are different: \* Household 1 (income €30,000) has a weight of $w_{3,1} = 50$. \* Household 2 (income €40,000) has a weight of $w_{3,2} = 60$. \* Household 3 (income €100,000) has a weight of $w_{3,3} = 45$. \* Let's say the total population of households in Murau is $N_3 = 10,000$.

The formula becomes: $$\hat{\bar{Y}}_3 = \frac{1}{10000} \sum_{i \in s_3} w_{3i}Y_{3i}$$$$\hat{\bar{Y}}_3 = \frac{1}{10000} [ (50 \times 30,000) + (60 \times 40,000) + (45 \times 100,000) ]$$$$\hat{\bar{Y}}_3 = \frac{1}{10000} [ 1,500,000 + 2,400,000 + 4,500,000 ]$$ $$\hat{\bar{Y}}_3 = \frac{1}{10000} [ 8,400,000 ] = €840$$

Wait! That's a completely different and extremely low result. Why? Because the formula as written is often used for estimating the **total** income and then converting it to a mean. A more common and practical formula for a direct *mean* estimate is:

$$\hat{\bar{Y}}_d = \frac{\sum_{i \in s_d} w_{di}Y_{di}}{\sum_{i \in s_d} w_{di}}$$

This formula calculates the total weighted income and divides it by the total of the weights, which represents the effective population size represented by the sample. This is essentially a weighted average.

Let's use this more common formula with our Murau example: \* **Sum of weighted incomes:** $(50 \times 30,000) + (60 \times 40,000) + (45 \times 100,000) = 8,400,000$ \* **Sum of weights:** $50 + 60 + 45 = 155$ \* **Direct Estimate for Murau:** $8,400,000 / 155 \approx €54,194$.

This value is still different from our initial simple average of €56,667, but it's a more accurate direct estimate because it correctly accounts for the different weights of the sampled households. The underlying principle, however, remains the same: it's an estimate based solely on the data from that specific district, and for a small district like Murau with a tiny sample size, this estimate still has a very high variance.

That's an excellent question, and it gets to the heart of the assumptions we make in statistics. When you have a formula like:

$$\hat{\bar{Y}}_d^{\mathrm{dir}} = \frac{1}{n_d} \sum_{i \in s_d} y_i$$

This is a much simpler form of a direct estimator, and it implies a key difference in the underlying survey design.

### The Key Difference: The Assumption of Simple Random Sampling

The formula $\hat{\bar{Y}}_d^{\mathrm{dir}} = \frac{1}{n_d} \sum_{i \in s_d} y_i$ is the formula for a **simple sample mean**. It calculates the average by simply summing up all the values in the sample and dividing by the number of observations in that sample ($n_d$).

This estimator is only appropriate and unbiased if the sample within district $d$ is a **simple random sample (SRS)**. A simple random sample means that every household in the district had an equal probability of being selected for the survey. In this case, we don't need weights because our sample is already perfectly representative of the population in that district (on average).

### Mapped to the Austrian Districts Example (with a new assumption)

Let's revisit our example with this new, simpler assumption. We'll use the same three districts: Wien, Graz, and Murau.

-   $d$: The specific district (Wien, Graz, or Murau).
-   $\hat{\bar{Y}}_d^{\mathrm{dir}}$: The direct estimate of the average income for district $d$.
-   $n_d$: The number of households sampled in district $d$. This is the *sample size*.
    -   For Wien, let's say $n_{\text{Wien}} = 200$.
    -   For Graz, $n_{\text{Graz}} = 50$.
    -   For Murau, $n_{\text{Murau}} = 3$.
-   $y_i$: The income of a specific sampled household $i$.
-   $\sum_{i \in s_d} y_i$: The sum of the incomes of all the households sampled in district $d$.

**Calculations under the SRS assumption:**

-   **Wien:** Sum of incomes of the 200 sampled households / 200. This gives us our direct estimate, say €45,000.
-   **Graz:** Sum of incomes of the 50 sampled households / 50. This gives us our direct estimate, say €46,000.
-   **Murau:** Sum of incomes of the 3 sampled households (€30,000, €40,000, and €100,000) / 3. This gives us our direct estimate of €56,667.

### How this is Different from the Previous Example

The previous example's formula, which included sample weights ($w_{di}$), was a much more realistic representation of how complex surveys are designed. Large-scale surveys like the one a national statistics office would run are almost never a simple random sample.

Here's why:

1.  **Stratification and Clustering:** To reduce costs and improve precision, surveys are often stratified (e.g., sampling more households in densely populated areas) and clustered (e.g., sampling many households from a few selected neighborhoods). This means that a household in a rural district has a different probability of being selected than a household in an urban district. The sampling weights ($w_{di}$) correct for these unequal probabilities.

2.  **Non-response:** Not every household selected for the survey will respond. The weights are adjusted to account for non-responding households, assuming that the respondents are similar to the non-respondents in their stratum.

**In summary, when you see the simpler formula without weights, it implies one of two things:**

1.  **The data is from a simple random sample within each district.** This is a strong, and often unrealistic, assumption for large-scale social surveys.
2.  **The sample weights have been omitted for simplicity in the context of the example.** In practice, if the survey was not an SRS, a statistician would always use the weighted formula to ensure the direct estimate is unbiased and representative of the true population.

The core problem of small areas having small sample sizes and, therefore, very high variance still holds true for both formulas. Whether you're calculating a simple average or a weighted average, a sample of 3 households is still a small, unreliable base for making an inference about the entire district.

You've brought up a very important and subtle point in survey statistics: the difference between sampling **with replacement** and **without replacement**, and how it affects the variance calculation. This is a topic that can get quite technical, so I'll do my best to explain it in simple terms, relating it back to our Austrian districts example.

First, let's clarify the two formulas you provided, as there seems to be a mix-up. The first formula, $\text{Var}(\hat{Y}_d^{\mathrm{dir}}) = \frac{\sum_{i \in s_d} w_i (w_i -1)y_i^2}{N_d^2}$, is not a standard variance estimator for direct means. It looks more like a component of a variance formula for a total, but it's not the correct or complete expression.

The second formula, $\text{Var}(\hat{Y}_d^{\mathrm{dir}}) = \frac{1}{n_d} \sum_{i \in s_d} (f_d w_i y_i - \hat{Y}_d^{\mathrm{dir}})^2$, also doesn't seem to be a standard variance estimator as written. The $f_d$ term suggests a finite population correction factor, which is used for sampling *without* replacement, but the overall structure is not a typical estimator.

Let's use the standard, correct variance formulas for a simple random sample (SRS) to explain the core concept. This is the simplest case that clearly shows the difference.

### The Core Concept: Simple Terms

Imagine you're trying to estimate the average income in the Murau district by sampling 3 households.

-   **Sampling *Without* Replacement:** This is the most common scenario. Once you've selected a household for your sample, you can't select it again. The total number of households you can choose from decreases with each selection.
    -   **In simple terms:** Knowing that you've selected household A tells you something about the remaining pool of households to choose from (household A isn't in it anymore). This information reduces the uncertainty of your estimate. You have a finite population, and by sampling from it, you are progressively reducing the unknown part of that population.
    -   **Effect on Variance:** The variance of your estimator is slightly smaller than if you sampled with replacement. The standard variance formula is often multiplied by a **finite population correction factor** (FPC). The FPC is $(1 - n_d/N_d)$, where $n_d$ is the sample size and $N_d$ is the total population size. As your sample size $n_d$ gets closer to the population size $N_d$, the FPC gets closer to zero, and the variance goes to zero. This makes sense: if you sample everyone, there's no uncertainty left!
-   **Sampling *With* Replacement:** This is less common in household surveys but useful to understand. You select a household, record its income, and then put it back into the pool of households to be selected again. It's possible to select the same household multiple times.
    -   **In simple terms:** Each selection is a completely independent event. Picking household A tells you nothing about the probability of picking household A again, or any other household. You are sampling from an "infinite" pool of possibilities, even though your real population is finite.
    -   **Effect on Variance:** The variance is always slightly larger than when sampling without replacement. There is no finite population correction factor because you are not "depleting" the population as you sample.

### The Standard Variance Formulas (for Simple Random Sampling)

Let's use the standard, correct formulas to make the distinction clear. For a simple random sample (SRS) mean estimate, $\hat{\bar{Y}}_d^{\mathrm{dir}} = \frac{1}{n_d} \sum_{i \in s_d} y_i$:

1.  **Variance *without* replacement:** $$\text{Var}(\hat{\bar{Y}}_d^{\mathrm{dir}}) = (1 - f_d) \frac{S_d^2}{n_d}$$
    -   $f_d = n_d / N_d$ is the **sampling fraction** (the proportion of the population you sampled).
    -   $S_d^2$ is the **population variance** of the income values in district $d$. Since we don't know the population variance, we estimate it with the sample variance, $s_d^2$. The $(1 - f_d)$ term is the finite population correction factor.
2.  **Variance *with* replacement:** $$\text{Var}(\hat{\bar{Y}}_d^{\mathrm{dir}}) = \frac{S_d^2}{n_d}$$
    -   The formula is simpler because there is no finite population correction factor.

### Back to our Austria Example

-   **Murau District (**$n=3$): The total number of households ($N_d$) in Murau is likely in the thousands.
    -   The sampling fraction $f_d = n_d / N_d$ would be an extremely small number (e.g., 3 / 10,000 = 0.0003).
    -   The finite population correction factor $(1 - f_d)$ would be very close to 1.
    -   **Conclusion:** For small sample sizes from large populations, the difference between the variance with and without replacement is **negligible**. The FPC term is essentially 1, so the two formulas give almost the same result. The uncertainty (variance) is dominated by the small sample size ($n_d$ in the denominator).
-   **A "census-like" sample:** Imagine a different scenario where you sampled 90 out of a population of 100 households. The sampling fraction is $f_d = 0.90$.
    -   The FPC would be $(1 - 0.90) = 0.10$.
    -   In this case, the variance of the without-replacement estimator would be only 10% of the variance of the with-replacement estimator. The difference is huge because you've sampled a large portion of the population.

**In simple terms:** The difference between the two variance formulas becomes important only when you are sampling a **significant proportion of the total population**. For the typical small area estimation scenario where you have a small sample from a large population, the difference is so small that it is often ignored or the formula for with-replacement is used for simplicity, because it's slightly more conservative (it gives a slightly larger, safer estimate of the uncertainty).

## What is the variance telling us again?

Thank you for providing those specific formulas. Let's work with the direct estimator and variance formulas you've supplied, as they represent a specific statistical method. It's common in different survey sampling textbooks and software to have variations in how these estimators are presented.

The direct estimator is: $$\hat{\bar{Y_d}}^{\mathrm{dir}} = \frac{1}{N_d} \sum_{i \in s_d} w_{di}y_{di}$$ This formula calculates the **estimated average income** for district $d$ by summing up the weighted incomes of the sampled households and dividing by the total population of households in the district ($N_d$). This is a common way to express the ratio of the estimated total income to the known population size.

The variance is: $$\text{Var}(\hat{\bar{Y}}_d^{\mathrm{dir}}) = \frac{\sum_{i \in s_d} w_i (w_i -1)y_i^2}{N_d^2}$$ This is a variance estimator for a total, specifically the **Horvitz-Thompson** or **Hajek** estimator, adapted for a population mean. It's a design-based variance estimator, meaning it's based on the survey's sampling design (the probabilities of selection) rather than a model.

Now, let's explain what this variance tells us in the context of our Austrian districts example.

### What the Variance Tells Us in Simple Terms

In our example, the variance, $\text{Var}(\hat{\bar{Y}}_d^{\mathrm{dir}})$, is a measure of the **uncertainty** or **precision** of our direct estimate of average income for a given district.

-   **A High Variance:**
    -   This tells us that our direct estimate, $\hat{\bar{Y_d}}^{\mathrm{dir}}$, is **unreliable**.
    -   It means that if we were to repeat our survey sampling process in that district many times, the direct estimates we would get each time would be **widely scattered**.
    -   In our Murau example, with a small sample size ($n_d=3$), the variance for its average income estimate would be very large. This reflects the high probability that our sample of three households is not representative of the entire district's income distribution. The estimate of €56,667 is likely far from the true average income, and a different sample could easily yield a very different estimate.
-   **A Low Variance:**
    -   This tells us that our direct estimate is **reliable** and **precise**.
    -   It means that if we were to repeat the survey, the direct estimates we would get would be **closely clustered** around the true average income.
    -   In our Wien example, with a large sample size ($n_d=200$), the variance would be small. This means our direct estimate of €45,000 is likely very close to the true average income of the district. We can be confident in this estimate.

### How the Formula Captures This

Let's look at the components of the variance formula to see how it reflects this reality: $$\text{Var}(\hat{\bar{Y}}_d^{\mathrm{dir}}) = \frac{1}{N_d^2} \sum_{i \in s_d} w_{di}(w_{di} -1)y_{di}^2$$

-   **The weights (**$w_{di}$): The term $w_{di}(w_{di}-1)$ is a key part of this variance formula. The weights are inversely proportional to the probability of selection. A household that has a very small chance of being selected will have a very large weight. This is typically the case for households in sparsely populated areas.

    -   For the Murau district, where we only sampled 3 households from a large population, these households will have large weights. For example, a weight of 100 would represent itself and 99 other households. The term $100(100-1)$ becomes a very large number, and when squared and multiplied by the income, it significantly inflates the variance.
    -   For the Wien district, with a much larger sample, the weights for each household will be smaller (e.g., 20). The term $20(20-1)$ is a much smaller number.

-   **The incomes (**$y_{di}^2$): The squared income of each sampled household is also in the formula. If a household with a very high income is sampled and it also has a large weight (as might happen in Murau), this single observation will contribute a large amount to the total variance, reflecting the high degree of uncertainty it introduces.

-   **The population size (**$N_d^2$): The total population size of the district is in the denominator. This helps to scale the variance appropriately for the size of the district.

In essence, the variance formula quantifies the impact of the **unequal weights and the small sample sizes** on the reliability of our direct estimate. A small sample with some very large weights (like in Murau) leads to a large variance, indicating low confidence. A large sample with more uniform, smaller weights (like in Wien) leads to a small variance, indicating high confidence.

This is why, in small area estimation, the direct estimate's variance ($V_i$ in our original model) is so critical. The higher the variance, the less we trust the direct estimate, and the more we rely on a model to provide a more stable and reliable estimate.

Area Level Model

This is an excellent summary of the Fay-Herriot model and how it addresses the limitations of direct estimators. Let's break down the linking model and its error terms, using our Austrian districts and average income example.

### The Fay-Herriot Model and Our Austria Example

The core idea of the Fay-Herriot model is to combine the unreliable direct estimator (the sampling model) with a more stable, model-based estimate (the linking model).

**1. The Sampling Model (Revisited with the example)**

$$\hat{\theta}_i^{\mathrm{DIR}} = \theta_i + \epsilon_i$$

-   $\hat{\theta}_i^{\mathrm{DIR}}$: Our direct estimate of average income for district $i$ (e.g., €56,667 for Murau, calculated from the small sample).
-   $\theta_i$: The true, but unknown, average income for district $i$.
-   $\epsilon_i$: The sampling error, which is large for districts with small samples (like Murau) and small for districts with large samples (like Wien). The variance of this error, $V_i$, is known from our survey design.

### 2. The Linking Model: The "Secret Sauce"

This is where we "borrow strength" from other areas and auxiliary data. The linking model assumes that the **true average income** ($\theta_i$) for a district is not completely random but is related to other known characteristics of that district.

$$\theta_i = x_i' \beta + u_i$$

-   $\theta_i$: The true average income for district $i$ (e.g., Murau). We're trying to model this value.

-   $x_i' \beta$: This is the **model-based part**. It's a linear regression that predicts the average income based on known, reliable data for each district. These are our "auxiliary variables" ($x_i$).

    -   $x_i$: A vector of auxiliary variables for district $i$. For our Austrian example, these could be:
        -   The average education level of the district.
        -   The average age of the population.
        -   The unemployment rate from a separate census-like source.
        -   The proportion of the population working in specific industries (e.g., agriculture vs. manufacturing).
    -   $\beta$: A vector of regression coefficients. These are unknown parameters that the model estimates from the data. They tell us how much each auxiliary variable affects the average income across all districts. For example, a positive $\beta$ for "average education level" would mean that districts with higher education tend to have higher average incomes.

-   $u_i$: This is the **area-specific random effect**. This is a very important part of the model.

    -   It represents the part of the true average income ($\theta_i$) that **cannot be explained** by the auxiliary variables ($x_i$). It's the unique, un-modeled characteristic of district $i$.
    -   For Murau, even after accounting for its demographics and industries, there might be unique local factors that make its true average income higher or lower than what the model predicts. The random effect $u_{\text{Murau}}$ captures this unique difference.
    -   The model assumes these effects are normally distributed with a mean of zero and a common variance $\sigma_u^2$. This means that on average, the auxiliary variables do a good job of predicting the income, but there is always some random, unique variation from district to district.

### The Error Terms: $\epsilon_i$ vs. $u_i$

This is a critical distinction in the Fay-Herriot model.

-   $\epsilon_i$ (Sampling Error): This is the error in our **measurement**. It's the random variability that comes from our survey's sampling process. This error is specific to the direct estimator.
    -   **Example:** The error in our Murau direct estimate is huge because of the tiny sample. The variance $V_{\text{Murau}}$ is large.
-   $u_i$ (Area-Specific Random Effect): This is the error in our **linking model**. It's the random variability that comes from our regression model not perfectly explaining the true income. This error is specific to the underlying true value $\theta_i$.
    -   **Example:** Even if we had a perfect census for all districts, a simple regression model wouldn't perfectly predict every district's average income. The random effect $u_i$ accounts for that inherent, unmodeled variability.

### The Advanced Error Term: Spatial Correlation

The final part of your description introduces a more advanced version of the linking model, which addresses a key limitation of the basic model.

$$u = \rho_1 Wu + \epsilon$$

-   **Basic Assumption:** The standard Fay-Herriot model assumes that the unique effects ($u_i$) for each district are **independent**. This means that a high true income in one district (after accounting for the auxiliary variables) tells us nothing about the true income in a neighboring district. This assumption is often wrong.

-   **The Reality:** In our Austria example, it's very likely that a district's true average income is correlated with its neighbors' incomes. If a district has a higher-than-expected income, its neighboring districts are also likely to have higher-than-expected incomes due to shared economic factors, commuter patterns, or other regional influences. This is called **spatial correlation**.

-   **The Advanced Model:** The equation you provided is a way to model this spatial correlation.

    -   $W$: This is an **adjacency matrix**. It's a mathematical representation of which districts are neighbors. For example, if Wien and Graz are neighbors, the matrix would have a 1 in the corresponding cell; otherwise, it would have a 0.
    -   $\rho_1$: This is a spatial **autoregression parameter**. It's a single value between -1 and 1 that tells us the strength of the spatial correlation.
        -   If $\rho_1$ is positive, it means that districts with a high random effect tend to be next to other districts with high random effects.
        -   If $\rho_1$ is close to 0, there is no spatial correlation, and the model simplifies to the basic Fay-Herriot model.
    -   **The new error term:** The new error term, $\epsilon$, is now assumed to be independent and identically distributed, and it is part of this new equation for $u$.

**In summary:** The linking model provides a way to estimate the true average income for each district by combining a regression model with auxiliary variables and a unique, random effect. The advanced version of this model acknowledges and quantifies the spatial correlation between neighboring districts, which often provides a more accurate and robust estimate, especially for areas with very small sample sizes.

Intercept only model

This is an excellent description of the simplest form of the Fay-Herriot model. It helps us understand the fundamental principle of "borrowing strength" without the added complexity of auxiliary variables. Let's break down the intercept-only model using our Austrian districts and income example.

### The Intercept-Only Model in Simple Terms

The intercept-only model is the most basic way to improve a direct estimator. It essentially says:

-   "We don't have any specific data (like demographics or education) to predict a district's income."
-   "Therefore, our best guess for any district's true income is the **overall average income for all of Austria**."
-   "However, we know that each district will have its own unique, random deviation from this average."
-   "We will combine this overall average with our direct estimate from the survey, giving more weight to the overall average when the direct estimate is unreliable (i.e., has a high variance)."

### The Elements Mapped to the Austrian Example

Let's look at the model equation and map it to our example:

$$\hat{Y}_i = \beta_0 + u_i + e_i$$

-   $\hat{Y}_i$: This is the **direct survey estimate of the average income** for district $i$. This is the same as $\hat{\theta}_i^{\mathrm{DIR}}$ from our earlier model.
    -   For Murau, $\hat{Y}_{\text{Murau}}$ is €56,667.
    -   For Wien, $\hat{Y}_{\text{Wien}}$ is €45,000.
-   $\beta_0$: This is the **overall intercept**, which represents the **global mean average income across all districts in Austria**.
    -   This value is estimated from the data from all districts combined. Let's say this value is calculated to be **€48,000**. This is the single, common "best guess" for any district's average income before we consider its unique survey data.
-   $u_i \sim N(0, \sigma_u^2)$: This is the **area-specific random effect**.
    -   It represents the unique, un-modeled deviation of a district's true average income from the global mean.
    -   For example, the true average income for Murau might be €50,000, which is €2,000 higher than the global mean of €48,000. So, $u_{\text{Murau}}$ would be +€2,000.
    -   This term is "random" because we assume these unique deviations are randomly distributed across all districts, with an average of zero and a common variance $\sigma_u^2$.
-   $e_i \sim N(0, D_i)$: This is the **sampling error**, with a known variance $D_i$. This is the same as $\epsilon_i$ and $V_i$ from our earlier model.
    -   This is the error that comes from our survey's sampling process.
    -   For Murau, $D_{\text{Murau}}$ is very large because the sample size is only 3.
    -   For Wien, $D_{\text{Wien}}$ is very small because the sample size is 200.

### How the Model "Shrinks" Estimates

The magic of the Fay-Herriot model lies in how it combines these terms to produce a final, "shrunken" estimate. The final estimate for a district is a weighted average of the **direct estimate** and the **global mean (**$\beta_0$).

The weight given to each of these components depends on the **variance of the sampling error (**$D_i$).

-   **For a district with a large sample (e.g., Wien):**
    -   $D_{\text{Wien}}$ is small. This means our direct estimate of €45,000 is very reliable.
    -   The model will give **a lot of weight** to the direct estimate. The final estimate will be very close to €45,000. It is "shrunk" very little, because it is already a good estimate.
-   **For a district with a small sample (e.g., Murau):**
    -   $D_{\text{Murau}}$ is large. This means our direct estimate of €56,667 is unreliable.
    -   The model will give **very little weight** to the direct estimate. Instead, it will give **a lot of weight** to the more stable global mean of €48,000.
    -   The final estimate for Murau will be "shrunk" considerably from the direct estimate of €56,667 towards the global mean of €48,000, resulting in a more plausible and reliable value.

### Why This Model is a Stepping Stone

The intercept-only model is a foundational example of a linear mixed model in small area estimation. It demonstrates the core principle of borrowing strength by using a common mean to stabilize unreliable estimates.

The full Fay-Herriot model, which includes auxiliary variables ($x_i' \beta$), is a more sophisticated version of this. It replaces the "global mean" with a **predicted value** from a regression model. This is generally a better approach because a district's predicted average income (based on its demographics) is usually a much better starting point than a simple global average. However, the intercept-only model perfectly illustrates the mechanism of variance-based shrinkage that is at the heart of all Fay-Herriot models.

With Auxilery Information:

This model is the full, classic Fay-Herriot model, and it represents a significant step up from the intercept-only model. It's the model that most effectively "borrows strength" by using all available information. Let's break it down using our Austrian districts and income example, focusing on how it differs from the previous model.

### The Fay-Herriot Model with Auxiliary Information

The core idea of this model is to replace the single, global mean ($\beta_0$) with a more intelligent, district-specific prediction based on other, known data. Instead of shrinking all unreliable estimates towards the same number, this model shrinks them towards a number that is predicted for that specific district.

The model is:
$$\hat{Y}_i = \beta_0 + \beta_1 \cdot \text{cash}_i + \beta_2 \cdot \text{unempl\_ben}_i + \beta_3 \cdot \text{tax\_adj}_i + u_i + e_i$$

### The Elements Mapped to the Austrian Example

* **$\hat{Y}_i$**: This is the **direct survey estimate of average income** for district $i$, exactly as before. For Murau, it's €56,667, and for Wien, it's €45,000.

* **$\beta_0$**: The **intercept**. This is now the estimated average income for a hypothetical district where all the auxiliary variables (`cash`, `unempl_ben`, `tax_adj`) are zero. It's no longer the overall average for all of Austria.

* **Auxiliary Variables and their Coefficients ($\beta_1$, $\beta_2$, $\beta_3$)**: This is the new, powerful part of the model. These variables are known for **all** districts in Austria (from a census or administrative data) and are used to predict income.
    * **$\text{cash}_i$**: Let's assume this is the proportion of the population in district $i$ receiving cash welfare benefits. A higher proportion of people on welfare might be associated with a lower average income. So, we would expect the coefficient $\beta_1$ to be **negative**.
    * **$\text{unempl\_ben}_i$**: This could be the proportion of the population in district $i$ receiving unemployment benefits. A higher rate of unemployment benefits would likely be associated with a lower average income, so we would expect $\beta_2$ to also be **negative**.
    * **$\text{tax\_adj}_i$**: This could be an average tax adjustment or a related variable that correlates positively with income. For instance, it might represent the average taxable income, which is a strong proxy for overall income. A higher value here would likely mean a higher average income, so we would expect $\beta_3$ to be **positive**.

* **$u_i$**: The **area-specific random effect**. Just as before, this term accounts for the unique, un-modeled factors of district $i$. It's the part of the true average income that the auxiliary variables **don't** explain.

* **$e_i$**: The **sampling error**, with its known variance $D_i$. This is the same as in the previous models.

### How this Model "Shrinks" Estimates More Effectively

The key difference is what the model "shrinks" towards.

* **Intercept-Only Model:** Shrank Murau's unreliable estimate of €56,667 towards the **single, global mean** for all of Austria (e.g., €48,000). The final estimate would be somewhere in between.

* **Fay-Herriot with Auxiliary Information:**
    1.  The model first uses the auxiliary variables to calculate a **district-specific predicted average income**. For Murau, with its rural nature and likely different proportions of `cash`, `unempl_ben`, and `tax_adj` compared to Wien, this model would likely predict a different income value than for Wien. Let's say the model predicts an income of **€49,000** for Murau.
    2.  The model then combines Murau's unreliable direct estimate of €56,667 with this more tailored, model-based prediction of €49,000.
    3.  Because Murau's direct estimate is highly unreliable (large $D_i$), the model will place a lot of weight on the prediction and little weight on the direct estimate. The final, shrunken estimate will be much closer to €49,000 than to €56,667.

### Why This Model is Better

Using auxiliary information makes the Fay-Herriot model more powerful and its estimates more credible.

1.  **More Plausible Predictions:** The model-based prediction is no longer a generic national average. It's a value tailored to the specific characteristics of the district. This makes the "shrunk" estimates more realistic and less likely to be biased. For example, if a small, rural district has a unique economic profile, the model will account for this and shrink its estimate towards a value that is appropriate for its profile, not just the national average.

2.  **Increased Precision:** By explaining some of the variation in true average income using the auxiliary variables, the model can more accurately separate the true variation from the sampling error. This results in more precise and reliable estimates for all areas, especially for those with small samples. The random effect ($u_i$) now only has to account for the variation not explained by the auxiliary variables, which makes its variance, $\sigma_u^2$, smaller. This leads to a more efficient and accurate final estimate.

In summary, this model is the full expression of the Fay-Herriot approach. It uses a rich set of data to create a more sophisticated model, which in turn leads to more accurate and reliable estimates for small areas.

## Spatial Model

This is the most advanced and often most realistic version of the Fay-Herriot model. It takes the idea of "borrowing strength" one step further by assuming that areas that are physically close to each other are more alike than areas that are far apart. This is a very common and logical assumption in social and economic data.

Let's break down the spatial model equation:
$$\boldsymbol{u} = \rho W \boldsymbol{u} + \boldsymbol{\epsilon}, \quad \boldsymbol{\epsilon} \sim \mathcal{N}(\boldsymbol{0}, \sigma^2 I)$$

### The Core Concept in Simple Terms

The basic Fay-Herriot model assumes that the unique, un-modeled part of a district's income ($u_i$) is completely independent of the unique, un-modeled part of any other district's income. It's like flipping a coin for each district to decide if its income will be higher or lower than the model predicts.

The spatial model, however, says: "That's not how the world works. If a district's true income is higher than the model predicts, its neighboring districts are likely to also have a higher-than-predicted income."

The spatial model explicitly builds this neighborhood influence directly into the equation. It models the area-specific random effect ($\boldsymbol{u}$) as being composed of two parts:

1.  A part that is a function of the random effects of its neighbors.
2.  A part that is a purely independent, random error.

### The Elements Mapped to the Austrian Example

* **$\boldsymbol{u}$**: This is no longer a single random effect $u_i$ for one district, but a **vector of all random effects for all districts** ($u_1, u_2, \ldots, u_M$). This is represented by the bold notation. It's the collection of all the un-modeled unique deviations for every district in Austria.

* **$W$**: This is the **adjacency matrix** (or a spatial weights matrix). It is a square matrix that defines which districts are "neighbors."
    * It has dimensions $M \times M$ (e.g., $94 \times 94$ for all Austrian districts).
    * A value in the matrix, $W_{ij}$, is 1 if district $i$ and district $j$ are neighbors and 0 otherwise. Sometimes, the weights are not just 0 or 1 but are based on a distance or shared border length.
    * This matrix is the "map" that tells the model which districts are geographically connected.

* **$\rho$**: This is the **spatial autocorrelation parameter**. It's a single number between -1 and 1 that tells us how strong the neighborhood influence is.
    * If $\rho$ is close to **1**, there is strong positive spatial correlation. This means that if a district's income is higher than predicted, its neighbors' incomes are also very likely to be higher than predicted.
    * If $\rho$ is close to **0**, there is no spatial correlation, and the model simplifies back to the basic Fay-Herriot model.
    * If $\rho$ is close to **-1**, there is strong negative spatial correlation (e.g., a high-income district is next to a low-income district), but this is less common in socio-economic data.

* **$\boldsymbol{\epsilon}$**: This is a new, independent error term. It is a vector of random errors, one for each district. It's the truly random part of the unique deviation that is not explained by the spatial relationship.

### How the Spatial Model Works in Practice

Let's go back to our Murau example. The direct estimate is still highly unreliable due to the tiny sample.

1.  The model first calculates a predicted income for Murau based on its auxiliary variables (demographics, etc.), say €49,000.
2.  It then looks at the **neighboring districts** of Murau. Let's say Murau's neighbors have a higher-than-predicted true income on average, even after accounting for their auxiliary variables.
3.  The spatial model uses the $\rho W \boldsymbol{u}$ part of the equation to "borrow strength" from these neighbors. Because of the positive spatial correlation ($\rho > 0$), the model will adjust Murau's estimate upwards, suggesting that its unique, un-modeled income is also likely to be higher than the model-based prediction.
4.  The final estimate for Murau will be a weighted average of its unreliable direct estimate, its model-based prediction, **and the estimated random effects of its neighbors**.

This approach provides a more robust and accurate estimate. For a district with a very small sample size, the direct estimate is almost completely ignored. The final estimate is a blend of its model-based prediction and the information from its neighbors, which provides a much more credible and stable result than relying on a single global average or just the auxiliary data alone.

Reference:

Paul A Parker, Scott H Holan, Ryan Janicki, Conjugate Modeling Approaches for Small Area Estimation with Heteroscedastic Structure, *Journal of Survey Statistics and Methodology*, Volume 12, Issue 4, September 2024, Pages 1061–1080, <https://doi.org/10.1093/jssam/smad002>
